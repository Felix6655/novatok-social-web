<analysis>
<original_problem_statement>
The user wants to upgrade the existing NovaTok Social project to prepare it for future AI features. This involves a significant architectural refactor to make the codebase more modular and scalable.

The project is to be delivered in phases, with the immediate focus being **Phase 1: Foundation**.

**Phase 1 Requirements:**
1.  **Audit**: Audit all existing routes and tabs to identify dead UI (UI that isn't wired to any logic).
2.  **Folder Structure**: Create and normalize the folder structure to separate concerns:
    *   
        *    (routing)
        *    (shared UI)
        *    (feature-specific logic and components)
        *    (central API client)
        *   
        *   
        *   
        *   
3.  **API Client**: Implement a central API client/service layer for handling HTTP requests, authentication, retries, and standardized errors.
4.  **Environment Variables**: Add robust handling for environment variables, distinguishing between public () and server-only secrets.
5.  **Shared UI Patterns**: Create shared components for Loading, Error, and Empty states.
6.  **Refactor Two Tabs**: Refactor at least two existing feature tabs to use the new modular architecture and central service layer.
</original_problem_statement>

**User's preferred language**: English

**what currently exists?**
A feature-rich Next.js 14 web application, NovaTok Social, operating primarily in a demo mode. It uses  and client-side data generation for most features.

**Key Features Completed:**
-   **Core UI:** A responsive dark-themed layout with a persistent sidebar, a new global footer, and a premium animated constellation background.
-   **Reels & Rooms:** Video reels (persisted to Supabase if configured) and real-time video rooms (powered by LiveKit if configured).
-   **Horoscope:** A visually rich sign selection grid using custom cinematic poster images for each zodiac sign.
-   **SoulMate:** An advanced dating/matching feature with a swipeable UI. It uses a sophisticated client-side generator to create 5,000 realistic synthetic profiles, including fields like job, education, and height. The infrastructure is in place to use local photorealistic AI-generated images (from ), though the images themselves have not been provided yet.
-   **Music:** A fully integrated  page with a discover feed, genre filters, and a persistent mini-player. It was migrated from an external link to an internal route.
-   **Global Footer:** A compact, responsive, site-wide footer with link columns, a functional newsletter subscription form, and social media links.

**Last working item**:
-   Last item agent was working: The agent was instructed to begin **Phase 1: Foundation** of a major architectural upgrade. The agent acknowledged the task and performed an initial audit by listing the application's page routes.
-   Status: **NOT STARTED**
-   Agent Testing Done: N
-   Which testing method agent to use? This is a large refactoring task. The agent should test incrementally. After refactoring each feature, it should use the **frontend testing agent** (screenshot tool) to verify the UI remains intact and functional.
-   User Testing Done: N

**All Pending/In progress Issue list**:
-   Issue 1: (P0) Perform Phase 1 Architectural Upgrade.

  Issues Detail:
  - **Issue 1**: Perform Phase 1 Architectural Upgrade.
     - **Attempted fixes**: None. The agent has only listed files.
     - **Next debug checklist**:
         1.  Create the new  directory.
         2.  Create the subdirectories: , , , , , , .
         3.  Begin moving existing files into the new structure (e.g., move  to ,  to ,  contents into , , etc.).
         4.  Update all import paths across the application to reflect the new structure.
         5.  Create a central API service file in  to handle future API calls.
         6.  Create shared , , and  state components in .
         7.  Select two simple features (e.g., Horoscope, Tarot) and refactor their logic to align with the new feature-based structure.
     - **Why fix this issue and what will be achieved with the fix?** To fulfill the user's direct request to make the codebase more modular, scalable, and ready for future AI feature integrations.
     - **Status**: NOT STARTED
     - **Is recurring issue?** N
     - **Should Test frontend/backend/both after fix?** Frontend
     - **Blocked on other issue**: None

**In progress Task List**:
-   Task 1: Phase 1: Foundation - Architectural Upgrade (P0)

 Task Detail:
  - **Task 1**: Phase 1: Foundation - Architectural Upgrade
     - **Where to resume**: The agent has completed the initial audit. The next step is to create the new  directory and its subfolders, and then begin migrating existing code into the new structure.
     - **What will be achieved with this?** A more organized, maintainable, and scalable codebase, laying the groundwork for future AI feature development.
     - **Status**: NOT STARTED
     - **Should Test frontend/backend/both after fix?** Frontend
     - **Blocked on something**: No

**Upcoming and Future Tasks**
-   **Upcoming Tasks**:
    -   **(P0) Phase 2: AI Studio**: Implement a new AI Studio tab for AI image and video generation, as requested by the user.
    -   **(P1) Phase 3: Reels + Social Loop**: Integrate the outputs of the AI Studio into the Reels feature.
-   **Future Tasks**:
    -   **(P1) Music Deep Integration**: The previous task to add generated artwork, a Continue Listening home page widget, music attachments for posts, and a token rewards system for the Music feature. This was superseded by the architecture upgrade but remains a future goal.
    -   **(P1) Connect V1 Features to Supabase**: Migrate data persistence for , , , and  from  to a real backend.
    -   **(P1) Social Feed Backend Integration**: Connect the Social Feed MVP to a backend for real users, posts, and comments.
    -   **(P2) Implement Go Live Backend**: Upgrade the  feature to use LiveKit's broadcast capabilities.

**Completed work in this session**
-   **NovaTok Music Link**: Added a permanent external link to the sidebar, then later converted it to an internal link.
-   **Constellation Background**: Implemented a new, premium, animated constellation background ().
-   **Horoscope UI Upgrade**: Replaced icon-based zodiac selectors with cinematic poster images ().
-   **SoulMate Feature (MVP & Enhancements)**:
    -   Built a client-side generator for 5,000 synthetic profiles ().
    -   Created swipeable profile cards, match modals, and settings UI ().
    -   Enhanced realism with more data fields (job, education, etc.) and UI polish (badges, skeleton loading).
    -   Implemented infrastructure to support photorealistic AI-generated photos from a local directory ().
-   **Global Footer**: Created and integrated a responsive, site-wide footer, then refactored it to be more compact ().
-   **NovaTok Music Integration**: Migrated the feature from an external site to a fully integrated internal route at  with a functional UI and mini-player.

**Earlier issues found/mentioned but not fixed**
   - **Issue 1**: Linter warnings for .
     - **Debug checklist**: These are noted as intentional to handle client-side state fetching in the app's demo-first architecture. They should be ignored as fixing them could cause hydration errors.
     - **Why to solve this issue and what will be achieved with this?** This is not an issue to be solved.
     - **Should Test frontend/backend/both after fix**: N/A
     - **Is recurring issue?** Y

**Known issue recurrence from previous fork**
- None.

**Code Architecture**
The current architecture is a standard Next.js 14 App Router structure. The user has requested a migration to the following new structure:


**Key Technical Concepts**
-   **Framework**: Next.js 14 (App Router)
-   **Styling**: Tailwind CSS, 
-   **Database/Auth**: Supabase (optional, via env vars)
-   **Real-time Video**: LiveKit (optional, via env vars)
-   **Architecture**:
    -   **Demo Mode First**: Features are built to work in a UI-only mode using  and client-side data generation, and can be upgraded with backend credentials.
    -   **Client-Side State**: Extensive use of  and .
    -   **Upcoming Refactor**: The app is about to be refactored into a more modular, feature-based architecture.

**key DB schema**
-   : 

**changes in tech stack**
-   None in this session.

**All files of reference**
-   Files to be created/moved as part of the refactor (see **Code Architecture**).
-   : The main layout file, modified multiple times to add the sidebar link, constellation background, and footer.
-   : The complex client-side data generator for the SoulMate feature.
-   : The new global footer component.
-   : The new internal music page.

**Areas that need refactoring**:
-   The entire project is the subject of the next refactoring task as per the user's latest request.
-   The file  remains a very large monolithic component that should be broken down.

**key api endpoints**
-   : Mints a client-side access token for joining a LiveKit room.

**Critical Info for New Agent**
-   **Your immediate and only priority is to execute Phase 1 of the architectural upgrade.** The user has pivoted from feature development to a foundational refactor.
-   Do not work on the Music Deep Integration task (message #240). This task has been superseded.
-   Follow the Phase 1 plan precisely: create the new  directory structure, move existing files, update imports, and then refactor two small features to use the new pattern.
-   The goal is to establish a scalable foundation for future AI features. This is a structural task, not a feature-building task.

**documents created in this job**
-    (placeholder for upcoming images).

**Last 10 User Messages and any pending HUMAN messages**
1.  **User**: Start Phase 1 of a major architectural upgrade. (PENDING)
2.  **User**: Finalize NovaTok Music with deep integration (artwork, rewards, etc.). (SUPERSEDED)
3.  **User**: Refactor the footer to be more compact. (COMPLETED)
4.  **User**: Build a site-wide footer. (COMPLETED)
5.  **User**: Awaiting photorealistic image upload for SoulMate. (ADDRESSED - infrastructure is ready)
6.  **User**: Implement infrastructure for local photorealistic photos. (COMPLETED)
7.  **User**: Decided to use Lorelei DiceBear avatars for SoulMate. (COMPLETED, but then superseded)
8.  **User**: Asked for a decision on synthetic avatar source. (ADDRESSED)
9.  **User**: Improve SoulMate realism with more data and UI polish. (COMPLETED)
10. **User**: Build a SoulMate demo dataset with 5,000 profiles. (COMPLETED)

**Project Health Check:**
-   **Broken**: None.
-   **Mocked**: Almost all features rely on client-side mock data, , or data generators. This includes Social Feed, Go Live, SoulMate, Music, and core content pages. This is the intended demo mode behavior.

**3rd Party Integrations**
-   **@supabase/supabase-js**: For Auth, DB, and Storage. Requires User-provided API Keys.
-   **LiveKit**: For real-time video. Requires User-provided API Keys.

**Testing status**
-   Testing agent used after significant changes: NO (Agent used  for manual verification).
-   Troubleshoot agent used after agent stuck in loop: NO
-   Test files created: None.
-   Known regressions: None.

**Credentials to test flow:**
-   No credentials are required. The application runs in a full-featured demo mode by default.

**What agent forgot to execute**
-   The agent was about to begin the deep integration of the Music feature but was interrupted by the user with a new, higher-priority task to refactor the entire application architecture. The agent correctly pivoted to the new task.

</analysis>
